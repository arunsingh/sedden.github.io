<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Forwarding IPv6 Traffic from WAN to LAN with OpenWRT</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

        <!-- Favicon -->
        <link href="/favicon.png" rel="icon">

        <!-- OpenID -->
        <link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
        <link rel="openid2.local_id" href="https://openid.stackexchange.com/user/2cd92ecb-186e-42d2-839e-e1b36cc3d6fb">

        <!-- Feed -->
        <link type="application/atom+xml" rel="alternate" href="/atom.xml"/>

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">A developer's notebook</a></h1>
            <a class="extra" href="/">home</a>
            <a class="extra" href="/about/">about</a>
            <a class="extra" href="/atom.xml">feed</a>
          </div>

          <h2>Forwarding IPv6 Traffic from WAN to LAN with OpenWRT</h2>
<p class="meta">26 Mar 2013</p>

<div class="post">
<p>We&#39;re starting from the premise that you already enabled IPv6. If not so, this will help you to switch it on:</p>

<ul>
<li><a href="http://www.sixxs.net/wiki/Aiccu/Installing_on_OpenWRT">Aiccu/Installing on OpenWRT</a></li>
<li><a href="http://wiki.openwrt.org/doc/howto/ipv6">IPv6 HowTo on Backfire and later</a></li>
</ul>

<p>OpenWRT Attitude Adjustment 2012.09 warning: There is an ongoing discussion regarding the AICCU init script. If you can, stay with OpenWRT Backfire 2010.3.</p>

<p>I&#39;m using SixxS tunnels to enable IPv6. My <code>/etc/config/network</code> looks like this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">config interface &#39;lan&#39;
    # ...
    option ip6addr &#39;2001:my:subnet:prefix::1/64&#39;

config &#39;interface&#39; &#39;wan6&#39;
    # ...
    option &#39;ip6addr&#39; &#39;2001:my:end:point::2&#39;
</code></pre></div>
<p>To enable that your local server is reachable via SSH (port 22) add this rule to <code>/etc/config/firewall</code> straight after the standard IPv6 rules: </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">config rule
       option &#39;src&#39; &#39;wan6&#39;
       option &#39;proto&#39; &#39;tcp&#39;
       option &#39;dest_port&#39; &#39;22&#39;
       option &#39;dest_ip&#39; &#39;2001:your:servers:global:ipv6:address:####:####&#39;
       option &#39;family&#39; &#39;ipv6&#39;
       option &#39;target&#39; &#39;ACCEPT&#39;
       option &#39;dest&#39; &#39;lan&#39; 
</code></pre></div>
<p>Also make sure that you installed the <code>ip6tables</code> Package,
then restart the firewall with <code>/etc/init.d/firewall restart</code>
and test your setup.</p>

</div>

<div>



	<p><a href="/blog/2013/03/25/run-puppet-via-cron">« Run Puppet via Cron</a></p>



	<p><a href="/blog/2013/03/27/use-osfamily-instead-of-operatingsystem">Pros and cons using Puppet's $::osfamily instead of $::operatingsystem Fact »</a></p>


</div>


          <div class="footer">
            <div class="contact">
              <p>
                Stefan Jenkner<br />
                stefan@jenkner.org
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/sedden">github.com/sedden</a><br />
                <a href="https://twitter.com/sedden">twitter.com/sedden</a> 
                <a href="https://alpha.app.net/sedden">alpha.app.net/sedden</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
